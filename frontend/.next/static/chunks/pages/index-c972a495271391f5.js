(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return i(1435)}])},1435:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return td}});var n=i(5893),l=i(7294),o=i(5007),a=i(154),r=i(8773),s=i(3454);let d=(0,a.hg)("presentation/generateOutline",async e=>{try{let t={context:e.topic,num_slides:e.numSlides,instructional_level:e.instructionalLevel};console.log("\uD83D\uDE80 Sending outline request:",t),console.log("\uD83C\uDF0D API URL:","".concat(s.env.NEXT_PUBLIC_API_BASE_URL||"https://ai-powerpoint-f44a1d57b590.herokuapp.com","/api/generate/outline"));let i=await fetch("".concat(s.env.NEXT_PUBLIC_API_BASE_URL||"https://ai-powerpoint-f44a1d57b590.herokuapp.com","/api/generate/outline"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!i.ok){let e=await i.text();throw console.error("❌ Server error:",e),Error("API Error: ".concat(i.statusText))}let n=await i.json();return console.log("✅ API Response:",n),(Array.isArray(n.topics)?n.topics:[n.topics]).map(e=>({id:(0,r.Z)(),title:"string"==typeof e?e:e.title,key_points:Array.isArray(e.key_points)?e.key_points:[],image_prompt:e.image_prompt||"",description:e.description||""}))}catch(e){throw console.error("❌ Failed to generate outline:",e),e}}),c=(0,a.hg)("presentation/generateSlides",async(e,t)=>{let{getState:i}=t;try{let t=i(),n=[];for(let i of e){let e={topic:{title:i.title,key_points:i.key_points,image_prompt:i.image_prompt,description:i.description},instructional_level:t.presentation.instructionalLevel,layout:t.presentation.defaultLayout};console.log("\uD83D\uDE80 Sending slide generation request:",JSON.stringify(e,null,2));let l=await fetch("".concat(s.env.NEXT_PUBLIC_API_BASE_URL||"https://ai-powerpoint-f44a1d57b590.herokuapp.com","/api/generate/slides"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!l.ok){let e=await l.text();throw console.error("❌ Server error:",e),Error("API Error: ".concat(l.statusText))}let o=await l.json();console.log("✅ API Response:",o);let a={id:i.id||String(Date.now()),layout:e.layout,content:{title:o.title||i.title,subtitle:o.subtitle||"",body:o.body||"",bullets:o.bullet_points||i.key_points.map(e=>({text:e})),image:o.image_url?{url:o.image_url,alt:o.image_alt||i.image_prompt||"",caption:o.image_caption||i.image_prompt||"",service:"generated",prompt:i.image_prompt||""}:void 0,image_prompt:i.image_prompt||"",instructionalLevel:t.presentation.instructionalLevel}};console.log("Generated Slide:",a),n.push(a)}return n}catch(e){throw console.error("❌ Failed to generate slides:",e),e}}),u=(0,a.hg)("presentation/updateTopicPoint",async e=>e),p=(0,a.hg)("presentation/deleteTopicPoint",async e=>e),g=(0,a.hg)("presentation/addTopicPoint",async e=>e),x=(0,a.oM)({name:"presentation",initialState:{outline:[],slides:[],activeSlideId:null,isGeneratingSlides:!1,isGeneratingOutline:!1,error:null,instructionalLevel:"high_school",defaultLayout:"title-bullets"},reducers:{setSlides:(e,t)=>{e.slides=t.payload},updateOutline:(e,t)=>{console.log("Updating outline with:",t.payload),e.outline=t.payload},setActiveSlide:(e,t)=>{console.log("Setting active slide to:",t.payload),e.activeSlideId=t.payload},setError:(e,t)=>{e.error=t.payload},setInstructionalLevel:(e,t)=>{e.instructionalLevel=t.payload},setDefaultLayout:(e,t)=>{e.defaultLayout=t.payload},reorderSlides:(e,t)=>{let{startIndex:i,endIndex:n}=t.payload,[l]=e.slides.splice(i,1);e.slides.splice(n,0,l)}},extraReducers:e=>{e.addCase(d.pending,e=>{e.isGeneratingOutline=!0,e.error=null}).addCase(d.fulfilled,(e,t)=>{e.isGeneratingOutline=!1,e.outline=t.payload,e.error=null}).addCase(d.rejected,(e,t)=>{e.isGeneratingOutline=!1,e.error={message:t.error.message||"Failed to generate outline",context:{topic:""}}}).addCase(c.pending,e=>{e.isGeneratingSlides=!0,e.error=null}).addCase(c.fulfilled,(e,t)=>{e.slides=[...e.slides,...t.payload],e.isGeneratingSlides=!1}).addCase(c.rejected,(e,t)=>{e.isGeneratingSlides=!1,e.error={message:t.error.message||"Failed to generate slides",context:t.meta.arg[0]?{topic:t.meta.arg[0].title}:void 0}}).addCase(u.fulfilled,(e,t)=>{let{topicId:i,pointIndex:n,newText:l}=t.payload,o=e.outline.find(e=>e.id===i);o&&(o.key_points[n]=l)}).addCase(p.fulfilled,(e,t)=>{let{topicId:i,pointIndex:n}=t.payload,l=e.outline.find(e=>e.id===i);l&&l.key_points.splice(n,1)}).addCase(g.fulfilled,(e,t)=>{let{topicId:i,text:n}=t.payload,l=e.outline.find(e=>e.id===i);l&&l.key_points.push(n)})}}),{setSlides:m,updateOutline:h,setActiveSlide:f,setError:v,setInstructionalLevel:b,setDefaultLayout:y,reorderSlides:j}=x.actions;var Z=x.reducer;let w=(0,a.xC)({reducer:{presentation:Z}}),C=o.v9;var S=i(5616),I=i(5861),D=i(1903),k=i(4054),P=i(3841),_=i(1683),E=i(8972),A=i(9417),T=i(8456);function L(e){return"title-body-image"===e?"title-bullets-image":e}let B=e=>({supportsImage:e.includes("image"),supportsBody:e.includes("body"),supportsBullets:e.includes("bullets"),supportsSubtitle:"title-only"===e||"title-image"===e,supportsColumns:e.includes("column")}),R=[{layout:"title-only",title:"Title Only",description:"Simple title slide with optional subtitle",preview:"\uD83D\uDCDD",features:B("title-only")},{layout:"title-image",title:"Title with Image",description:"Title slide with an image",preview:"\uD83D\uDDBC️",features:B("title-image")},{layout:"title-body",title:"Title with Body",description:"Title with paragraph text",preview:"\uD83D\uDCC4",features:B("title-body")},{layout:"title-body-image",title:"Title with Body and Image",description:"Title with paragraph text and image",preview:"\uD83D\uDCC4\uD83D\uDDBC️",features:B("title-body-image")},{layout:"title-bullets",title:"Title with Bullets",description:"Title with bullet points",preview:"\uD83D\uDCCB",features:B("title-bullets")},{layout:"title-bullets-image",title:"Title with Bullets and Image",description:"Title with bullet points and image",preview:"\uD83D\uDCCB\uD83D\uDDBC️",features:B("title-bullets-image")},{layout:"two-column",title:"Two Columns",description:"Title with two text columns",preview:"\uD83D\uDD32\uD83D\uDD32",features:B("two-column")},{layout:"two-column-image",title:"Two Columns with Image",description:"Title with two columns and image",preview:"\uD83D\uDD32\uD83D\uDDBC️",features:B("two-column-image")}];var W=()=>{var e,t;let i=(0,o.I0)(),a=(0,o.v9)(e=>e.presentation.instructionalLevel),r=(0,o.v9)(e=>e.presentation.defaultLayout),s=(0,o.v9)(e=>e.presentation.isGeneratingOutline),c=(0,o.v9)(e=>e.presentation.error),[u,p]=(0,l.useState)(""),[g,x]=(0,l.useState)("5"),m=async e=>{if(e.preventDefault(),console.log("handleSubmit fired!"),!u.trim()||!g){i(v({message:"Please fill in all required fields",context:{topic:""}}));return}try{await i(d({topic:u.trim(),numSlides:parseInt(g,10),instructionalLevel:a})).unwrap(),p(""),x("5")}catch(e){console.error("Failed to generate outline:",e)}};return(0,n.jsxs)(S.Z,{component:"form",onSubmit:m,sx:{p:2},children:[(0,n.jsx)(I.Z,{variant:"h6",gutterBottom:!0,children:"Generate Presentation"}),(0,n.jsxs)(S.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,n.jsx)(D.Z,{label:"Topic",value:u,onChange:e=>p(e.target.value),error:(null==c?void 0:null===(e=c.context)||void 0===e?void 0:e.topic)==="",helperText:(null==c?void 0:null===(t=c.context)||void 0===t?void 0:t.topic)===""?c.message:"",fullWidth:!0,required:!0}),(0,n.jsx)(D.Z,{label:"Number of Slides",type:"number",value:g,onChange:e=>x(e.target.value),inputProps:{min:1,max:20},fullWidth:!0,required:!0}),(0,n.jsxs)(S.Z,{sx:{display:"flex",gap:2},children:[(0,n.jsxs)(k.Z,{fullWidth:!0,children:[(0,n.jsx)(P.Z,{children:"Instructional Level"}),(0,n.jsxs)(_.Z,{value:a,onChange:e=>{i(b(e.target.value))},label:"Instructional Level",children:[(0,n.jsx)(E.Z,{value:"elementary",children:"Elementary School"}),(0,n.jsx)(E.Z,{value:"middle_school",children:"Middle School"}),(0,n.jsx)(E.Z,{value:"high_school",children:"High School"}),(0,n.jsx)(E.Z,{value:"university",children:"University"}),(0,n.jsx)(E.Z,{value:"professional",children:"Professional"})]})]}),(0,n.jsxs)(k.Z,{fullWidth:!0,children:[(0,n.jsx)(P.Z,{children:"Default Layout"}),(0,n.jsx)(_.Z,{value:r,onChange:e=>{i(y(e.target.value))},label:"Default Layout",children:R.map(e=>(0,n.jsx)(E.Z,{value:e.layout,children:e.title},e.layout))})]})]}),(0,n.jsx)(A.Z,{type:"submit",variant:"contained",disabled:s,sx:{minWidth:150},children:s?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(T.Z,{size:24,sx:{mr:1},color:"inherit"}),"Generating..."]}):"Generate Outline"})]})]})},z=i(657),N=i(7645),O=i(6580),F=i(1425),G=i(629),U=i(8462),H=i(9875),q=i(8885),M=i(9334),J=i(3395),X=i(3946),Y=i(1596),K=i(6693),Q=i(1379),V=i(7957),$=i(1733),ee=i(6540),et=i(7376);let ei=e=>{let{open:t,text:i,onClose:o,onSave:a}=e,[r,s]=(0,l.useState)(i);return(0,n.jsxs)(z.Z,{open:t,onClose:o,children:[(0,n.jsx)(N.Z,{children:"Edit Point"}),(0,n.jsx)(O.Z,{children:(0,n.jsx)(D.Z,{autoFocus:!0,margin:"dense",label:"Point",fullWidth:!0,multiline:!0,rows:3,value:r,onChange:e=>s(e.target.value)})}),(0,n.jsxs)(F.Z,{children:[(0,n.jsx)(A.Z,{onClick:o,children:"Cancel"}),(0,n.jsx)(A.Z,{onClick:()=>{a(r),o()},variant:"contained",color:"primary",children:"Save"})]})]})};var en=()=>{let e=(0,o.I0)(),t=(0,o.v9)(e=>e.presentation.outline),i=(0,o.v9)(e=>e.presentation.isGeneratingSlides),a=(0,o.v9)(e=>e.presentation.error),[r,s]=(0,l.useState)(!1),[d,x]=(0,l.useState)(null),m=(e,t,i)=>{x({topicId:e,index:t,text:i}),s(!0)},h=(t,i)=>{e(p({topicId:t,pointIndex:i}))},f=t=>{e(g({topicId:t,text:"New point"}))},v=(e,t)=>(0,n.jsxs)(G.Z,{sx:{mb:2,p:2},children:[(0,n.jsx)(I.Z,{variant:"h6",children:e.title}),e.description&&(0,n.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",mb:1},children:[(0,n.jsx)(Q.Z,{sx:{mr:1,color:"text.secondary"}}),(0,n.jsx)(I.Z,{variant:"body2",color:"text.secondary",children:e.description})]}),(0,n.jsxs)(U.Z,{dense:!0,children:[e.key_points.map((i,l)=>(0,n.jsxs)(H.ZP,{children:[(0,n.jsx)(q.Z,{sx:{minWidth:32},children:(0,n.jsx)(Y.Z,{color:"primary"})}),(0,n.jsx)(M.Z,{primary:"string"==typeof i?i:i.text}),(0,n.jsxs)(J.Z,{children:[(0,n.jsx)(X.Z,{edge:"end","aria-label":"edit",onClick:()=>m(e.id,l,"string"==typeof i?i:i.text),sx:{mr:1},children:(0,n.jsx)(V.Z,{})}),(0,n.jsx)(X.Z,{edge:"end","aria-label":"delete",onClick:()=>h(e.id,l),children:(0,n.jsx)($.Z,{})})]})]},"point-".concat(t,"-").concat(l))),(0,n.jsx)(H.ZP,{children:(0,n.jsx)(A.Z,{startIcon:(0,n.jsx)(ee.Z,{}),onClick:()=>f(e.id),sx:{mt:1},children:"Add Point"})})]}),e.image_prompt&&(0,n.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",mt:1},children:[(0,n.jsx)(K.Z,{sx:{mr:1,color:"text.secondary"}}),(0,n.jsxs)(I.Z,{variant:"body2",color:"text.secondary",children:["Image: ",e.image_prompt]})]}),e.subtopics&&e.subtopics.length>0&&(0,n.jsx)(S.Z,{sx:{ml:3,mt:2},children:e.subtopics.map((e,t)=>v(e,t))})]},e.id||"topic-".concat(t));return i?(0,n.jsxs)(S.Z,{sx:{p:3,textAlign:"center"},children:[(0,n.jsx)(T.Z,{size:40}),(0,n.jsx)(I.Z,{variant:"h6",sx:{mt:2},children:"Generating Slides..."})]}):(0,n.jsxs)(S.Z,{sx:{p:3},children:[t.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(S.Z,{sx:{mb:3,display:"flex",alignItems:"center",gap:2},children:[(0,n.jsx)(A.Z,{variant:"contained",startIcon:(0,n.jsx)(et.Z,{}),onClick:()=>{let i=[],n=e=>{e.forEach(e=>{i.push(e),e.subtopics&&n(e.subtopics)})};n(t),e(c(i))},disabled:i,sx:{minWidth:200},children:"Generate All Slides"}),a&&(0,n.jsx)(I.Z,{color:"error",variant:"body2",children:a.message})]}),t.map((e,t)=>v(e,t))]}),(0,n.jsx)(ei,{open:r,text:(null==d?void 0:d.text)||"",onClose:()=>s(!1),onSave:t=>{d&&e(u({topicId:d.topicId,pointIndex:d.index,newText:t}))}})]})},el=i(1292),eo=i(6818),ea=i(5343),er=i(6235),es=i(7958),ed=i(1659),ec=i(6242),eu=i(4267),ep=i(6761),eg=e=>{var t;let{slide:i,isDragging:l=!1,isActive:o=!1,onClick:a,onDelete:r,index:s=0}=e;return(0,n.jsx)(ec.Z,{onClick:a,sx:{cursor:"pointer",transition:"all 0.2s",transform:l?"scale(1.02)":"none","&:hover":{boxShadow:2},...o&&{borderColor:"primary.main",borderWidth:2,borderStyle:"solid"}},children:(0,n.jsx)(eu.Z,{sx:{p:0},children:(0,n.jsxs)(S.Z,{sx:{p:1.5,position:"relative"},children:[(0,n.jsxs)(S.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:.5},children:[(0,n.jsxs)(I.Z,{variant:"caption",color:"text.secondary",children:["Slide ",s+1]}),r&&(0,n.jsx)(el.Z,{title:"Delete slide",children:(0,n.jsx)(X.Z,{size:"small",onClick:e=>{e.stopPropagation(),r()},sx:{opacity:0,transition:"opacity 0.2s","&:hover":{opacity:1},".MuiCard-root:hover &":{opacity:.7}},children:(0,n.jsx)(ep.Z,{fontSize:"small"})})})]}),(0,n.jsx)(I.Z,{variant:"body2",sx:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:1.4,fontWeight:o?500:400,color:o?"primary.main":"text.primary"},children:i.content.title||"Untitled Slide"}),(null===(t=i.content.image)||void 0===t?void 0:t.url)&&(0,n.jsx)(S.Z,{sx:{mt:1,width:"100%",height:"60px",borderRadius:1,overflow:"hidden",position:"relative",bgcolor:"action.hover"},children:(0,n.jsx)("img",{src:i.content.image.url,alt:i.content.image.alt||"",style:{width:"100%",height:"100%",objectFit:"cover"}})})]})})})};let ex=e=>({userSelect:"none",padding:16,margin:"0 0 ".concat(8,"px 0"),background:e?"#f5f5f5":"white",border:"1px solid #e0e0e0",borderRadius:"4px",cursor:"grab",opacity:e?.5:1}),em=(0,l.memo)(e=>{let{slide:t,index:i,isActive:l,onSelect:o,onDelete:a,onDragStart:r,onDragEnd:s,onDragOver:d}=e;return(0,n.jsx)("div",{draggable:!0,onDragStart:()=>r(i),onDragEnd:s,onDragOver:e=>{e.preventDefault(),d(i)},style:ex(!1),children:(0,n.jsx)(eg,{slide:t,index:i,isActive:l,onClick:()=>o(t.id),onDelete:()=>a(t.id)})})});em.displayName="DraggableItem";let eh=e=>{let{slides:t,activeSlideId:i,onSlidesReorder:o,onSlideSelect:a,onSlideDelete:r}=e,[s,d]=(0,l.useState)(null),c=(0,l.useCallback)(e=>{d(e)},[]),u=(0,l.useCallback)(()=>{d(null)},[]),p=(0,l.useCallback)(e=>{if(null===s||s===e)return;let i=[...t],[n]=i.splice(s,1);i.splice(e,0,n),o(i),d(e)},[s,t,o]);return Array.isArray(t)&&0!==t.length?(0,n.jsx)(S.Z,{sx:{height:"100%",overflowY:"auto"},children:(0,n.jsx)(S.Z,{sx:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",p:2},children:(0,n.jsx)(S.Z,{sx:{width:332},children:t.map((e,t)=>(0,n.jsx)(em,{slide:e,index:t,isActive:e.id===i,onSelect:a,onDelete:r,onDragStart:c,onDragEnd:u,onDragOver:p},e.id))})})}):null};eh.displayName="SlideSorter";var ef=(0,l.memo)(eh),ev=i(3907),eb=e=>{let{open:t,onClose:i,onSave:o,slides:a}=e,[r,s]=(0,l.useState)("presentation"),[d,c]=(0,l.useState)("pptx"),u=async()=>{let e=new ev.Z;for(let i of a){var t;let n=e.addSlide();if(n.addText(i.content.title,{x:.5,y:.5,w:"90%",fontSize:24,bold:!0}),i.content.body&&n.addText(i.content.body,{x:.5,y:1.5,w:"90%",fontSize:14}),i.content.bullets&&n.addText(i.content.bullets.map(e=>({text:e.text})),{x:.5,y:1.5,w:"90%",bullet:!0,fontSize:14}),null===(t=i.content.image)||void 0===t?void 0:t.url)try{n.addImage({path:i.content.image.url,x:.5,y:i.content.bullets||i.content.body?3:1.5,w:"90%",h:3})}catch(e){console.error("Error adding image:",e)}"two-column"===i.layout&&i.content.columnLeft&&i.content.columnRight&&(n.addText(i.content.columnLeft,{x:.5,y:1.5,w:"45%",fontSize:14}),n.addText(i.content.columnRight,{x:5.5,y:1.5,w:"45%",fontSize:14}))}return e},p=e=>"pptx"===e?"application/vnd.openxmlformats-officedocument.presentationml.presentation":"application/json",g=e=>"pptx"===e?".pptx":".json",x=async()=>{try{let e=await window.showSaveFilePicker({suggestedName:"".concat(r).concat(g(d)),types:[{description:"pptx"===d?"PowerPoint Presentation":"JSON Files",accept:{[p(d)]:[g(d)]}}]}),t=await e.createWritable();if("pptx"===d){let e=await u(),i=await e.stream(),n=new Blob([i],{type:p("pptx")});await t.write(n)}else{let e={slides:a,version:"1.0",savedAt:new Date().toISOString()};await t.write(JSON.stringify(e,null,2))}await t.close(),o(r),i()}catch(e){console.error("Error saving file:",e)}};return(0,n.jsxs)(z.Z,{open:t,onClose:i,maxWidth:"sm",fullWidth:!0,children:[(0,n.jsx)(N.Z,{children:"Save Presentation"}),(0,n.jsxs)(O.Z,{children:[(0,n.jsx)(D.Z,{autoFocus:!0,margin:"dense",label:"Filename",type:"text",fullWidth:!0,value:r,onChange:e=>s(e.target.value),sx:{mt:1,mb:2},helperText:"Choose a name for your presentation"}),(0,n.jsxs)(k.Z,{fullWidth:!0,children:[(0,n.jsx)(P.Z,{children:"Format"}),(0,n.jsxs)(_.Z,{value:d,label:"Format",onChange:e=>c(e.target.value),children:[(0,n.jsx)(E.Z,{value:"pptx",children:"PowerPoint (.pptx)"}),(0,n.jsx)(E.Z,{value:"json",children:"JSON (.json)"})]})]})]}),(0,n.jsxs)(F.Z,{children:[(0,n.jsx)(A.Z,{onClick:i,children:"Cancel"}),(0,n.jsx)(A.Z,{onClick:x,variant:"contained",color:"primary",children:"Choose Location & Save"})]})]})},ey=i(2221),ej=i(6886),eZ=i(948),ew=i(2456),eC=i(7422);let eS=(0,eZ.ZP)("div")(e=>{let{theme:t}=e;return{width:"100%",height:"100%",minHeight:200,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:t.spacing(2),padding:t.spacing(3),border:"2px dashed ".concat(t.palette.divider),borderRadius:t.shape.borderRadius,transition:t.transitions.create(["border-color","background-color"]),"&:hover":{backgroundColor:t.palette.action.hover,borderColor:t.palette.primary.main}}}),eI=(0,eZ.ZP)("img")({maxWidth:"100%",maxHeight:"300px",objectFit:"contain",borderRadius:8});var eD=e=>{let{currentImage:t,onImageChange:i,onImageUpload:o,onImageGenerate:a,maxWidth:r=1920,maxHeight:s=1080,acceptedTypes:d=["image/jpeg","image/png","image/gif"]}=e,[c,u]=(0,l.useState)(!1),[p,g]=(0,l.useState)(null),[x,m]=(0,l.useState)((null==t?void 0:t.prompt)||""),h=(0,l.useCallback)(async e=>{if(o)try{u(!0),g(null);let t=await o(e);i({url:t,alt:e.name,caption:e.name,service:"upload"})}catch(e){g("Failed to upload image. Please try again."),console.error("Image upload error:",e)}finally{u(!1)}},[o,i]),f=(0,l.useCallback)(async()=>{if(!a||!x.trim()){g("Please enter a prompt for image generation");return}try{u(!0),g(null);let e=await a(x,"dalle");i({url:e,alt:x,caption:x,service:"dalle",prompt:x})}catch(e){g("Failed to generate image. Please try again."),console.error("Image generation error:",e)}finally{u(!1)}},[a,i,x]),v=(0,l.useCallback)(e=>{var t;let i=null===(t=e.target.files)||void 0===t?void 0:t[0];i&&h(i)},[h]),b=(0,l.useCallback)(e=>{var t;e.preventDefault();let i=null===(t=e.dataTransfer.files)||void 0===t?void 0:t[0];i&&h(i)},[h]);return(0,n.jsx)(S.Z,{children:(null==t?void 0:t.url)?(0,n.jsxs)(S.Z,{sx:{textAlign:"center"},children:[(0,n.jsx)(eI,{src:t.url,alt:t.alt||"Slide image"}),(0,n.jsx)(S.Z,{sx:{mt:2,display:"flex",gap:1,justifyContent:"center"},children:a&&(0,n.jsx)(A.Z,{variant:"outlined",startIcon:(0,n.jsx)(ew.Z,{}),onClick:f,disabled:c||!x.trim(),children:"Regenerate Image"})})]}):(0,n.jsx)(eS,{onDrop:b,onDragOver:e=>e.preventDefault(),onDragEnter:e=>e.preventDefault(),children:c?(0,n.jsxs)(S.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:[(0,n.jsx)(T.Z,{}),(0,n.jsx)(I.Z,{children:"Generating image..."})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eC.Z,{sx:{fontSize:48,color:"action.active"}}),(0,n.jsx)(I.Z,{variant:"body1",color:"text.secondary",align:"center",children:"Drag and drop an image here, or click to select"}),(0,n.jsxs)(S.Z,{sx:{display:"flex",flexDirection:"column",gap:2,alignItems:"center",width:"100%",maxWidth:400},children:[a&&(0,n.jsx)(D.Z,{label:"Image Prompt",value:x,onChange:e=>m(e.target.value),fullWidth:!0,multiline:!0,rows:2,placeholder:"Enter a description of the image you want to generate..."}),(0,n.jsxs)(S.Z,{sx:{display:"flex",gap:2},children:[(0,n.jsxs)(A.Z,{variant:"contained",component:"label",disabled:c||!o,children:["Upload Image",(0,n.jsx)("input",{type:"file",hidden:!0,accept:d.join(","),onChange:v})]}),a&&(0,n.jsx)(A.Z,{variant:"outlined",onClick:f,disabled:c||!x.trim(),children:"Generate Image"})]})]}),p&&(0,n.jsx)(I.Z,{variant:"body2",color:"error",align:"center",children:p})]})})})};let ek=[{value:"title-bullets",label:"Title & Bullets",description:"A title with bullet points below"},{value:"title-bullets-image",label:"Title, Bullets & Image",description:"A title with bullet points and an image below"},{value:"title-body",label:"Title & Body",description:"A title with a text body below"},{value:"title-image",label:"Title & Image",description:"A title with an image below"},{value:"title-body-image",label:"Title, Body & Image",description:"A title with a text body and an image below"},{value:"two-column",label:"Two Columns",description:"Content split into two columns"}];var eP=e=>{var t;let{open:i,onClose:o,slide:a,onSave:r,onImageUpload:s,onImageGenerate:d}=e,[c,u]=(0,l.useState)({...a,layout:L(a.layout),content:{...a.content,bullets:a.content.bullets?[...a.content.bullets]:[],image:a.content.image||(a.content.image_prompt?{url:"",alt:a.content.image_prompt,caption:a.content.image_prompt,prompt:a.content.image_prompt,service:"dalle"}:void 0)}});(0,l.useEffect)(()=>{u({...a,layout:L(a.layout),content:{...a.content,bullets:a.content.bullets?[...a.content.bullets]:[],image:a.content.image||(a.content.image_prompt?{url:"",alt:a.content.image_prompt,caption:a.content.image_prompt,prompt:a.content.image_prompt,service:"dalle"}:void 0)}}),!a.content.image_prompt||a.content.image&&a.content.image.url||(console.log("Auto-generating image in edit dialog"),b(a.content.image_prompt))},[a]);let p=e=>{let t={title:c.content.title||"",subtitle:c.content.subtitle,body:"title-body"===e||"title-body-image"===e?c.content.body||"":void 0,bullets:"title-bullets"===e||"title-bullets-image"===e?c.content.bullets||[]:void 0,columnLeft:"two-column"===e?c.content.columnLeft||"":void 0,columnRight:"two-column"===e?c.content.columnRight||"":void 0,image:"title-image"===e||"title-bullets-image"===e||"title-body-image"===e?c.content.image:void 0};u({...c,layout:e,content:t})},g=e=>{u({...c,content:{...c.content,subtitle:e}})},x=e=>{let t=[...c.content.bullets||[]];t.splice(e,1),u({...c,content:{...c.content,bullets:t}})},m=(e,t)=>{let i=[...c.content.bullets||[]];i[e]={text:t},u({...c,content:{...c.content,bullets:i}})},h=e=>{u({...c,content:{...c.content,columnLeft:e}})},f=e=>{u({...c,content:{...c.content,columnRight:e}})},v=e=>{u(t=>({...t,content:{...t.content,image:e}}))},b=async e=>{if(d)try{console.log("SlideEditDialog - Generating image with prompt:",e);let t=await d(e,"dalle");v({url:t,alt:e,caption:e,service:"dalle",prompt:e})}catch(e){console.error("Failed to generate image:",e)}};return(0,n.jsxs)(z.Z,{open:i,onClose:o,maxWidth:"md",fullWidth:!0,children:[(0,n.jsx)(N.Z,{children:"Edit Slide"}),(0,n.jsx)(O.Z,{children:(0,n.jsxs)(ey.Z,{spacing:3,sx:{mt:1},children:[(0,n.jsxs)(k.Z,{fullWidth:!0,sx:{mb:3},children:[(0,n.jsx)(P.Z,{children:"Layout"}),(0,n.jsx)(_.Z,{value:c.layout,label:"Layout",onChange:e=>p(e.target.value),children:ek.map(e=>(0,n.jsx)(E.Z,{value:e.value,children:e.label},e.value))})]}),(0,n.jsx)(D.Z,{label:"Title",fullWidth:!0,value:c.content.title||"",onChange:e=>{u({...c,content:{...c.content,title:e.target.value}})}}),(0,n.jsx)(D.Z,{label:"Subtitle",fullWidth:!0,value:c.content.subtitle||"",onChange:e=>g(e.target.value)}),("title-body"===c.layout||"title-body-image"===c.layout)&&(0,n.jsx)(D.Z,{fullWidth:!0,label:"Body",multiline:!0,rows:4,value:c.content.body||"",onChange:e=>{u({...c,content:{...c.content,body:e.target.value}})}}),("title-bullets"===c.layout||"title-bullets-image"===c.layout)&&(0,n.jsxs)(S.Z,{children:[(0,n.jsx)(I.Z,{variant:"h6",gutterBottom:!0,children:"Bullet Points"}),null===(t=c.content.bullets)||void 0===t?void 0:t.map((e,t)=>(0,n.jsxs)(S.Z,{sx:{display:"flex",gap:1,mb:1},children:[(0,n.jsx)(D.Z,{fullWidth:!0,value:e.text,onChange:e=>m(t,e.target.value),placeholder:"Bullet point ".concat(t+1)}),(0,n.jsx)(X.Z,{onClick:()=>x(t),color:"error",size:"small",children:(0,n.jsx)($.Z,{})})]},t)),(0,n.jsx)(A.Z,{startIcon:(0,n.jsx)(ee.Z,{}),onClick:()=>{let e=[...c.content.bullets||[],{text:""}];u({...c,content:{...c.content,bullets:e}})},variant:"outlined",size:"small",sx:{mt:1},children:"Add Bullet Point"})]}),"two-column"===c.layout&&(0,n.jsxs)(ej.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(ej.ZP,{item:!0,xs:6,children:(0,n.jsx)(D.Z,{fullWidth:!0,label:"Left Column",multiline:!0,rows:4,value:c.content.columnLeft||"",onChange:e=>h(e.target.value)})}),(0,n.jsx)(ej.ZP,{item:!0,xs:6,children:(0,n.jsx)(D.Z,{fullWidth:!0,label:"Right Column",multiline:!0,rows:4,value:c.content.columnRight||"",onChange:e=>f(e.target.value)})})]}),("title-image"===c.layout||"title-bullets-image"===c.layout||"title-body-image"===c.layout)&&(0,n.jsxs)(S.Z,{children:[(0,n.jsx)(I.Z,{variant:"h6",gutterBottom:!0,children:"Image"}),(0,n.jsx)(eD,{currentImage:c.content.image,onImageChange:v,onImageUpload:s,onImageGenerate:d})]})]})}),(0,n.jsxs)(F.Z,{children:[(0,n.jsx)(A.Z,{onClick:o,children:"Cancel"}),(0,n.jsx)(A.Z,{onClick:()=>{var e;r({...c,layout:"title-bullets-image"===(e=c.layout)?"title-body-image":e}),o()},variant:"contained",children:"Save"})]})]})},e_=i(2700);let eE=(0,eZ.ZP)(S.Z)(e=>{let{theme:t}=e;return{width:"100%",maxWidth:"960px",height:"calc(960px * 9/16)",display:"flex",flexDirection:"column",padding:t.spacing(4),backgroundColor:"#ffffff",borderRadius:t.spacing(1),boxShadow:"0 1px 3px rgba(0,0,0,0.12)",position:"relative",overflow:"auto",margin:"0 auto","@media (max-width: 1200px)":{width:"100%",height:"calc(100vw * 9/16)",maxHeight:"calc(100vh - 200px)"}}});var eA=e=>{let{children:t,error:i,onErrorClose:l}=e;return(0,n.jsxs)(eE,{children:[i&&(0,n.jsx)(S.Z,{sx:{position:"absolute",top:0,left:0,right:0,zIndex:1},children:(0,n.jsxs)(e_.Z,{severity:"SAFETY_VIOLATION"===i.type?"error":"RATE_LIMIT"===i.type||"QUOTA_EXCEEDED"===i.type?"warning":"NETWORK_ERROR"===i.type?"error":"warning",onClose:l,sx:{m:1},children:[i.message,i.service&&" (".concat(i.service,")"),i.retryAfter&&" - Please try again in ".concat(i.retryAfter," seconds")]})}),t]})};let eT=(0,eZ.ZP)(S.Z)(e=>{let{theme:t}=e;return{padding:t.spacing(4),height:"100%",display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"stretch",gap:t.spacing(2)}}),eL=(0,eZ.ZP)(S.Z)(e=>{let{theme:t}=e;return{flex:1,display:"flex",flexDirection:"column",gap:t.spacing(2)}}),eB=(0,eZ.ZP)(I.Z)(e=>{let{theme:t}=e;return{fontSize:"2rem",fontWeight:"bold",color:t.palette.text.primary}}),eR=(0,eZ.ZP)(S.Z)(e=>{let{theme:t}=e;return{display:"flex",flexDirection:"column",gap:t.spacing(1)}}),eW=(0,eZ.ZP)(I.Z)(e=>{let{theme:t}=e;return{fontSize:"1.25rem",color:t.palette.text.secondary,"&:before":{content:'"•"',marginRight:t.spacing(1)}}}),ez=(0,eZ.ZP)(S.Z)(e=>{let{theme:t}=e;return{width:"100%",height:"200px",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden",borderRadius:t.shape.borderRadius,backgroundColor:t.palette.background.paper}});var eN=e=>{var t,i;let{slide:l,onChange:o,onImageUpload:a,onImageGenerate:r}=e;return(0,n.jsx)(eA,{children:(0,n.jsx)(eT,{children:(0,n.jsxs)(eL,{children:[(0,n.jsx)(eB,{children:l.content.title}),(0,n.jsx)(eR,{children:null===(t=l.content.bullets)||void 0===t?void 0:t.map((e,t)=>(0,n.jsx)(eW,{children:e.text},t))}),(null===(i=l.content.image)||void 0===i?void 0:i.url)&&(0,n.jsx)(ez,{children:(0,n.jsx)(S.Z,{component:"img",src:l.content.image.url,alt:l.content.image.alt||"Slide image",sx:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})})]})})})},eO=i(7947),eF=i.n(eO),eG=i(1284),eU=i(4929),eH=i(6575),eq=i(7720),eM=i(4677),eJ=i(7911),eX=i(7320),eY=i(5551),eK=i(3516),eQ=i(1472),eV=i(1528),e$=e=>{let{editor:t,onImageClick:i}=e;if(!t)return null;let l=[{icon:(0,n.jsx)(eM.Z,{}),title:"Bold",action:()=>null==t?void 0:t.chain().focus().toggleBold().run(),isActive:()=>{var e;return null!==(e=null==t?void 0:t.isActive("bold"))&&void 0!==e&&e}},{icon:(0,n.jsx)(eJ.Z,{}),title:"Italic",action:()=>null==t?void 0:t.chain().focus().toggleItalic().run(),isActive:()=>{var e;return null!==(e=null==t?void 0:t.isActive("italic"))&&void 0!==e&&e}},{type:"divider"},{icon:(0,n.jsx)(eX.Z,{}),title:"Bullet List",action:()=>null==t?void 0:t.chain().focus().toggleBulletList().run(),isActive:()=>{var e;return null!==(e=null==t?void 0:t.isActive("bulletList"))&&void 0!==e&&e}},{icon:(0,n.jsx)(eY.Z,{}),title:"Numbered List",action:()=>null==t?void 0:t.chain().focus().toggleOrderedList().run(),isActive:()=>{var e;return null!==(e=null==t?void 0:t.isActive("orderedList"))&&void 0!==e&&e}},{type:"divider"},{icon:(0,n.jsx)(eK.Z,{}),title:"Heading",action:()=>null==t?void 0:t.chain().focus().toggleHeading({level:2}).run(),isActive:()=>{var e;return null!==(e=null==t?void 0:t.isActive("heading",{level:2}))&&void 0!==e&&e}},{icon:(0,n.jsx)(eQ.Z,{}),title:"Blockquote",action:()=>null==t?void 0:t.chain().focus().toggleBlockquote().run(),isActive:()=>{var e;return null!==(e=null==t?void 0:t.isActive("blockquote"))&&void 0!==e&&e}},{type:"divider"},{icon:(0,n.jsx)(eV.Z,{}),title:"Insert Image",action:()=>null==i?void 0:i(),isActive:()=>!1}];return(0,n.jsx)(S.Z,{sx:{display:"flex",gap:.5,p:1,backgroundColor:"background.paper",borderBottom:1,borderColor:"divider"},children:l.map((e,i)=>"type"in e?(0,n.jsx)(eq.Z,{orientation:"vertical",flexItem:!0},"divider-".concat(i)):(0,n.jsx)(el.Z,{title:e.title,children:(0,n.jsx)("span",{children:(0,n.jsx)(X.Z,{size:"small",onClick:e.action,color:e.isActive()?"primary":"default",disabled:!t.isEditable,children:e.icon})})},e.title))})},e0=e=>{let{content:t,onChange:i,placeholder:o="Start typing...",editable:a=!0,onMount:r,bulletList:s}=e,d=(0,eG.jE)({extensions:[eU.Z.configure({heading:{levels:[1,2,3]},bulletList:{keepMarks:!0,keepAttributes:!0},orderedList:{},blockquote:{}}),eH.ZP.configure({inline:!0,allowBase64:!0})],content:s&&!t?"<ul><li></li></ul>":t,editable:a,onUpdate:e=>{let{editor:t}=e;i(t.getHTML())},editorProps:{attributes:{class:"prose prose-sm sm:prose lg:prose-lg xl:prose-2xl mx-auto focus:outline-none",placeholder:o}},immediatelyRender:!1});return(0,l.useEffect)(()=>{d&&t!==d.getHTML()&&d.commands.setContent(t)},[d,t]),(0,l.useEffect)(()=>{d&&r&&r(d)},[d,r]),(0,l.useCallback)((e,t)=>{d&&d.chain().focus().setImage({src:e,alt:t}).run()},[d]),(0,n.jsxs)(S.Z,{className:"tiptap-editor-container",children:[d&&(0,n.jsx)(e$,{editor:d}),(0,n.jsx)(S.Z,{className:"tiptap-editor",children:(0,n.jsx)(eG.kg,{editor:d})}),(0,n.jsx)(eF(),{id:"1b4128af08d3b267",children:".tiptap-editor-container{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;border:1px solid#e2e8f0;-webkit-border-radius:.375rem;-moz-border-radius:.375rem;border-radius:.375rem;overflow:hidden}.tiptap-editor{position:relative;width:100%;min-height:100px;padding:1rem}.tiptap-editor:focus-within{border-color:#4f46e5;ring:2px;ring-color:#4f46e5}.ProseMirror{ul, ol {\n            padding-left: 1.5em;\n          }\n          blockquote {\n            border-left: 3px solid #e2e8f0;\n            padding-left: 1em;\n            margin-left: 0;\n            font-style: italic;\n          }\n          img {\n            max-width: 100%;\n            height: auto;\n          }\n          h1 {\n            font-size: 2em;\n            margin-bottom: 0.5em;\n          }\n          h2 {\n            font-size: 1.5em;\n            margin-bottom: 0.4em;\n          }\n          h3 {\n            font-size: 1.17em;\n            margin-bottom: 0.3em;\n          }\n          &[placeholder]:empty:before {\n            content: attr(placeholder);\n            color: #9ca3af;\n            pointer-events: none;\n            float: left;\n            height: 0;\n          }\n        >*+*{margin-top:.75em}&:focus{outline:none}}"})]})};let e1=(0,eZ.ZP)(S.Z)(e=>{let{theme:t}=e;return{padding:t.spacing(4),height:"100%",display:"flex",flexDirection:"column",gap:t.spacing(2)}}),e2=(0,eZ.ZP)(I.Z)(e=>{let{theme:t}=e;return{fontSize:"2rem",fontWeight:"bold",color:t.palette.text.primary}}),e5=(0,eZ.ZP)(S.Z)(e=>{let{theme:t}=e;return{fontSize:"1.25rem",color:t.palette.text.secondary,flex:1}});var e3=e=>{let{slide:t,onChange:i,onImageUpload:l,onImageGenerate:o}=e;return(0,n.jsx)(eA,{children:(0,n.jsxs)(e1,{children:[(0,n.jsx)(e2,{children:(0,n.jsx)(e0,{content:t.content.title||"",onChange:e=>{i({...t,content:{...t.content,title:e}})},placeholder:"Enter title...",bulletList:!1})}),(0,n.jsxs)(e5,{children:[(0,n.jsx)(e0,{content:t.content.body||"",onChange:e=>{i({...t,content:{...t.content,body:e}})},placeholder:"Enter content...",bulletList:!1}),t.layout.includes("image")&&(0,n.jsx)(eD,{currentImage:t.content.image?{...t.content.image,prompt:t.content.image.prompt||t.content.title||"Educational illustration"}:void 0,onImageChange:e=>{i({...t,content:{...t.content,image:{...e,prompt:e.prompt||t.content.title||"Educational illustration"}}})},onImageUpload:l,onImageGenerate:o})]})]})})};let e4=e=>{let{content:t,onChange:i,placeholder:l="Start typing...",type:o}=e,a=(0,eG.jE)({extensions:[eU.Z],content:t,onUpdate:e=>{let{editor:t}=e;i(t.getText())},editorProps:{attributes:{class:"prose prose-sm sm:prose lg:prose-lg xl:prose-2xl mx-auto focus:outline-none"}},immediatelyRender:!1});return a?(0,n.jsxs)(S.Z,{sx:{position:"relative",border:"1px solid",borderColor:"divider",borderRadius:1,p:1,"&:focus-within":{borderColor:"primary.main"},...(()=>{switch(o){case"slide":return{fontSize:"1.5rem",fontWeight:600,minHeight:"40px",width:"100%"};case"bullet":return{fontSize:"1rem",minHeight:"30px",width:"100%",pl:2,"&:before":{content:'"•"',position:"absolute",left:"0.5rem"}};case"body":return{fontSize:"1rem",minHeight:"100px",width:"100%"};default:return{}}})()},children:[(0,n.jsx)(eG.kg,{editor:a}),!t&&(0,n.jsx)(S.Z,{sx:{position:"absolute",top:"50%",transform:"translateY(-50%)",left:"1rem",color:"text.disabled",pointerEvents:"none"},children:l})]}):null},e6=(0,eZ.ZP)(G.Z)(e=>{let{theme:t}=e;return{width:"100%",aspectRatio:"16/9",padding:t.spacing(4),display:"flex",flexDirection:"column",gap:t.spacing(3),backgroundColor:t.palette.background.paper}}),e8=(0,eZ.ZP)(S.Z)(e=>{let{theme:t}=e;return{flex:"none","& .ProseMirror":{fontSize:"2rem",fontWeight:600,"&:focus":{outline:"none"}}}}),e9=(0,eZ.ZP)(S.Z)(e=>{let{theme:t}=e;return{flex:1,display:"flex",flexDirection:"column",gap:t.spacing(2),alignItems:"center",justifyContent:"center",minHeight:0}});(0,eZ.ZP)(S.Z)(e=>{let{theme:t}=e;return{width:"100%",maxHeight:"70%",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",borderRadius:t.shape.borderRadius,"& img":{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}}});var e7=e=>{let{slide:t,onChange:i,onImageUpload:o,onImageGenerate:a}=e,r=(0,l.useCallback)(e=>{i({...t,content:{...t.content,title:e}})},[t,i]),s=(0,l.useCallback)(e=>{i({...t,content:{...t.content,image:e}})},[t,i]);return(0,n.jsxs)(e6,{elevation:1,children:[(0,n.jsx)(e8,{children:(0,n.jsx)(e4,{content:t.content.title||"",onChange:r,placeholder:"Click to add title",type:"slide"})}),(0,n.jsx)(e9,{children:(0,n.jsx)(S.Z,{width:"60%",height:"100%",children:(0,n.jsx)(eD,{currentImage:t.content.image,onImageChange:s,onImageUpload:o,onImageGenerate:a,maxWidth:1920,maxHeight:1080})})})]})};let te=(0,eZ.ZP)(S.Z)(e=>{let{theme:t}=e;return{padding:t.spacing(4),height:"100%",display:"flex",flexDirection:"column",gap:t.spacing(2)}}),tt=(0,eZ.ZP)(I.Z)(e=>{let{theme:t}=e;return{fontSize:"2rem",fontWeight:"bold",color:t.palette.text.primary}}),ti=(0,eZ.ZP)(S.Z)(e=>{let{theme:t}=e;return{flex:1,display:"flex",gap:t.spacing(4)}}),tn=(0,eZ.ZP)(S.Z)(e=>{let{theme:t}=e;return{flex:1,fontSize:"1.25rem",color:t.palette.text.secondary}}),tl=(0,eZ.ZP)(S.Z)(e=>{let{theme:t}=e;return{flex:1,display:"flex",justifyContent:"center",alignItems:"flex-start"}});var to=e=>{let{slide:t,onChange:i,onImageUpload:l,onImageGenerate:o}=e;return(0,n.jsx)(eA,{children:(0,n.jsxs)(te,{children:[(0,n.jsx)(tt,{children:t.content.title}),(0,n.jsxs)(ti,{children:[(0,n.jsx)(tn,{children:t.content.body}),(0,n.jsx)(tl,{children:(0,n.jsx)(eD,{currentImage:t.content.image,onImageChange:e=>{i({...t,content:{...t.content,image:e}})},onImageUpload:l,onImageGenerate:o,maxWidth:1920,maxHeight:1080})})]})]})})},ta=e=>{let{slide:t,onChange:i=()=>{},onImageUpload:l,onImageGenerate:o}=e;switch(t.layout){case"title-bullets":default:return(0,n.jsx)(eN,{slide:t,onChange:i,onImageUpload:l,onImageGenerate:o});case"title-body":return(0,n.jsx)(e3,{slide:t,onChange:i,onImageUpload:l,onImageGenerate:o});case"title-image":return(0,n.jsx)(e7,{slide:t,onChange:i,onImageUpload:l,onImageGenerate:o});case"two-column":return(0,n.jsx)(to,{slide:t,onChange:i,onImageUpload:l,onImageGenerate:o})}},tr=()=>{let e=(0,o.I0)(),t=(0,l.useRef)(null),[i,a]=(0,l.useState)(!1),r=(0,o.v9)(e=>e.presentation.slides),s=(0,o.v9)(e=>e.presentation.activeSlideId),d=r.find(e=>e.id===s),c=r.findIndex(e=>e.id===s),[u,p]=(0,l.useState)(!1),[g,x]=(0,l.useState)(!1);(0,l.useEffect)(()=>{r.length>0&&!s&&e(f(r[0].id))},[r,s,e]);let h=async t=>{t!==s&&(r.find(e=>e.id===t),e(f(t)))},v=t=>{e(m(r.map(e=>e.id===t.id?t:e)))},b=async e=>URL.createObjectURL(e),y=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"dalle";try{console.log("SlideEditor - Generating image:",{prompt:e,service:t});let i=await fetch("http://localhost:8000/api/generate-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:e,context:{service:t}})});if(!i.ok){let e=await i.json();throw console.error("SlideEditor - Image generation failed:",e),Error(e.detail||"Failed to generate image")}let n=await i.json();return console.log("SlideEditor - Image generated:",n),n.imageUrl}catch(e){throw console.error("SlideEditor - Error generating image:",e),e}};return(0,l.useEffect)(()=>{let e=()=>{a(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),()=>document.removeEventListener("fullscreenchange",e)},[]),(0,n.jsxs)(S.Z,{ref:t,sx:{height:"100%",display:"flex",flexDirection:"column",position:"relative"},children:[(0,n.jsxs)(S.Z,{sx:{display:"flex",justifyContent:"flex-end",gap:1,p:1,bgcolor:"background.paper",borderBottom:1,borderColor:"divider"},children:[(0,n.jsx)(el.Z,{title:i?"Exit Fullscreen":"Enter Fullscreen",children:(0,n.jsx)("span",{children:(0,n.jsx)(X.Z,{onClick:()=>{if(document.fullscreenElement)document.exitFullscreen(),a(!1);else{var e;null===(e=t.current)||void 0===e||e.requestFullscreen().catch(e=>{console.error("Error attempting to enable full-screen mode:",e)}),a(!0)}},size:"large",children:i?(0,n.jsx)(er.Z,{}):(0,n.jsx)(ea.Z,{})})})}),(0,n.jsx)(el.Z,{title:"Edit Slide",children:(0,n.jsx)("span",{children:(0,n.jsx)(X.Z,{onClick:()=>x(!0),disabled:!d,size:"large",children:(0,n.jsx)(V.Z,{})})})}),(0,n.jsx)(el.Z,{title:"Save Presentation",children:(0,n.jsx)("span",{children:(0,n.jsx)(X.Z,{onClick:()=>p(!0),disabled:0===r.length,size:"large",children:(0,n.jsx)(eo.Z,{})})})})]}),(0,n.jsxs)(S.Z,{sx:{display:"flex",height:"100%",overflow:"hidden",bgcolor:"background.default"},children:[!i&&(0,n.jsxs)(S.Z,{sx:{width:300,borderRight:1,borderColor:"divider",display:"flex",flexDirection:"column"},children:[(0,n.jsx)(S.Z,{sx:{p:2,borderBottom:1,borderColor:"divider",display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,n.jsx)(I.Z,{variant:"h6",children:"Slides"})}),(0,n.jsx)(ef,{slides:r,onSlidesReorder:t=>{e(m(t)),!s&&t.length>0&&e(f(t[0].id))},onSlideSelect:h,onSlideDelete:t=>{let i=r.filter(e=>e.id!==t);e(m(i)),s===t&&i.length>0&&e(f(i[0].id))},activeSlideId:s||""})]}),(0,n.jsx)(S.Z,{sx:{flex:1,p:3,overflow:"auto",position:"relative"},children:d?(0,n.jsxs)(n.Fragment,{children:[i&&(0,n.jsxs)(S.Z,{sx:{position:"absolute",top:"50%",left:0,right:0,display:"flex",justifyContent:"space-between",px:2,transform:"translateY(-50%)",zIndex:1},children:[(0,n.jsx)(el.Z,{title:"Previous Slide",children:(0,n.jsx)("span",{children:(0,n.jsx)(X.Z,{onClick:()=>{c>0&&e(f(r[c-1].id))},disabled:0===c,size:"large",sx:{bgcolor:"background.paper","&:hover":{bgcolor:"action.hover"}},children:(0,n.jsx)(ed.Z,{})})})}),(0,n.jsx)(el.Z,{title:"Next Slide",children:(0,n.jsx)("span",{children:(0,n.jsx)(X.Z,{onClick:()=>{c<r.length-1&&e(f(r[c+1].id))},disabled:c===r.length-1,size:"large",sx:{bgcolor:"background.paper","&:hover":{bgcolor:"action.hover"}},children:(0,n.jsx)(es.Z,{})})})})]}),(0,n.jsx)(ta,{slide:d,onChange:v})]}):(0,n.jsx)(I.Z,{variant:"h6",sx:{textAlign:"center",mt:4},children:"Select a slide to edit"})})]}),(0,n.jsx)(eb,{open:u,onClose:()=>p(!1),onSave:e=>{console.log("Presentation saved as ".concat(e,".json"))},slides:r}),d&&(0,n.jsx)(eP,{open:g,onClose:()=>x(!1),slide:d,onSave:v,onImageUpload:b,onImageGenerate:y})]})},ts=()=>(C(e=>e.presentation.slides),(0,n.jsx)("div",{className:"min-h-screen bg-gray-100 py-6 px-4 sm:px-6 lg:px-8",children:(0,n.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,n.jsxs)("div",{className:"text-center mb-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Marvel AI Presentation Generator"}),(0,n.jsx)("p",{className:"mt-2 text-gray-600",children:"Create engaging presentations with AI-powered content generation"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)("div",{className:"bg-white shadow rounded-lg p-6",children:(0,n.jsx)(W,{})}),(0,n.jsx)("div",{className:"bg-white shadow rounded-lg p-6",children:(0,n.jsx)(en,{})})]}),(0,n.jsx)("div",{className:"bg-white shadow rounded-lg p-6",children:(0,n.jsx)(tr,{})})]})]})})),td=()=>(0,n.jsx)(o.zt,{store:w,children:(0,n.jsx)(ts,{})})},3180:function(){},7687:function(){}},function(e){e.O(0,[911,509,491,318,888,774,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);